language: ruby
rvm:
  - 2.4.4
before_script:
  - bundle exec rake db:create --all
  - bundle exec rake db:migrate
script:
  - bundle exec rake ci:tests
  - npm run test

cache:
  directories:
    - cd client && node_modules

after_script: # Upload coverage reports
  - cd client && COVERALLS_REPO_TOKEN=$coveralls_repo_token npm run coveralls

services:
  - postgresql
notifications:
  email: false
